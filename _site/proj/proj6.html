<!DOCTYPE html>
<html>
  <head>
     
     
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="shortcut icon" href="/static/img/favicon.ico" />
        <title>Impedance Control for Open Manipulator - Manuel Carita</title>
        <meta name="author" content="Manuel Carita" />
        <meta name="description" content="Impedance Control for Open Manipulator" />
        <meta name="keywords" content="Impedance Control for Open Manipulator, Manuel Carita, " />

        <meta content="" property="fb:app_id">
        <meta content="Manuel Carita" property="og:site_name">
        
          <meta content="Impedance Control for Open Manipulator" property="og:title">
        
        
          <meta content="article" property="og:type">
        
        
          <meta content="Hi there! This is a site where I can share some description about some interest projects throught my career. The main topics related are Computer Vision, Robotics, Machine Learning and EVs.
" property="og:description">
        
        
          <meta content="http://localhost:4000/proj/proj6" property="og:url">
        
        
        
          <meta content="http://localhost:4000/static/img/logo-high-resolution.png" property="og:image">
        
        
        
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@">
        <meta name="twitter:creator" content="@">
        
          <meta name="twitter:title" content="Impedance Control for Open Manipulator">
        
        
          <meta name="twitter:url" content="http://localhost:4000/proj/proj6">
        
        
          <meta name="twitter:description" content="Hi there! This is a site where I can share some description about some interest projects throught my career. The main topics related are Computer Vision, Robotics, Machine Learning and EVs.
">
        
        

      <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
      <script type="text/javascript">window.baseurl = 'http://localhost:4000';</script>
      
        <!-- Custom Fonts -->
        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">

        <!-- FontAwesome icons -->
        <link rel="stylesheet" href="https://use.fontawesome.com/74dfc6cf47.css">

        <!-- Core BootStrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <!-- Material Design CSS -->
        <link rel="stylesheet" href="/static/css/bootstrap-material-design.min.css">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/static/css/syntax.css">

        <!-- Custom CSS -->        
        <link rel="stylesheet" href="/static/css/thickbox.css">
        <link rel="stylesheet" href="/static/css/main.css">
        <link rel="stylesheet" href="/static/css/projects.css">

        <script type="text/javascript">
          //loadingImage is relative to project dir
          var tb_pathToImage = "/static/img/loadingAnimation.gif";
        </script>

    </head>

  <body class="home overflow-hidden">
    <div class="header-panel shadow-z-2">
      <div class="container">
        <div class="row">
          <div class="col-md-5 col-sm-5 col-xs-12">
            <div class="row-picture">
              <img id="about" class="logo-img" src="/static/img/logo.png" height="75px" width="75px">
            </div>
            <div class="row-details">
              <h3 class="list-group-item-heading" style="padding-top: 15%;font-size: 32px">Manuel Carita</h3>
              <h5 class="list-group-item-heading">Mechatronics Engineer</h5>
              <div class="social-icons">
	
        <a class="icon" target="_blank" href="https://www.linkedin.com/in/manuelcarita"><i class="fa fa-linkedin"></i></a>
    
        <a class="icon" target="_blank" href="https://github.com/manul30"><i class="fa fa-github"></i></a>
    
</div>

            </div>
            <div class="navbar-header pull-right">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <i class="fa fa-2x fa-bars"></i>
              </button>
            </div>
          </div>
          <div class="col-md-7 col-sm-7 col-xs-12">
          <div class="row">
            <h2 class="blog-title-pro " style="padding-top: 5%;padding-left: 40%;font-size: 24px;">Impedance Control for Open Manipulator</h2>
            
            </div>
            <p class="info">
              
              
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="container main outer">
      <div class="row">
        <div class="col-md-3 col-xs-12">
              <nav class="menu">
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="list-separator nav navbar-nav well well-primary project_page">

	
	
	
	
	
	
    
	
	<li class="col-lg-12 col-md-12 col-sm-4 col-xs-12  proj6"><a href="/" target="_self"><i class="fa fa-home"></i> Home</a></li>

	
	
	
	
	
	
    
	
	<li class="col-lg-12 col-md-12 col-sm-4 col-xs-12  proj6"><a href="/projects" target="_self"><i class="fa fa-desktop"></i> Projects</a></li>

	
	
	
	
	
	
    
	
	<li class="col-lg-12 col-md-12 col-sm-4 col-xs-12  proj6"><a href="/about" target="_self"><i class="fa fa-user"></i> About me</a></li>

	
	
	
	
	
	
    
	
	<li class="col-lg-12 col-md-12 col-sm-4 col-xs-12  proj6"><a href="/resume" target="_self"><i class="fa fa-graduation-cap"></i> Profile</a></li>

</ul>

    </div>
    </nav>

        </div>
        <div class="col-md-9 col-xs-12 full">
          <article class="post">
  <h3>Impedance Control for Open Manipulator</h3>
    
        
    
        
    
        
    
        
    
        
    
        
            
            
    <img src='/static/projects/proj6/gif.gif' alt="Project title image"/>
  <p> </p>
  <div class="post-content" align="justify/left/right/center">
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
</script>

<h2 id="intro">Intro</h2>

<p>Compliance in robotics, the ability of robots to react to external forces, has numerous real-life applications. In industries, compliant robots can work alongside humans, enhancing efficiency and safety in manufacturing. They can also be used in healthcare for delicate procedures and in disaster response for search and rescue operations. Overall, compliance in robotics enables safer and more effective human-robot interactions, revolutionizing various fields.</p>

<h2 id="metodology">Metodology</h2>

<p>In this project, the impedance control will run in a Open Manipulator Robot. You can search more information <strong><a href="https://emanual.robotis.com/docs/en/platform/openmanipulator_x/overview/">here</a></strong></p>

<p><img src="/proj/proj6/open_manipulator.png" style="display: block;margin-left: auto; margin-right: auto;" width="450" /></p>

<h3 id="impedance-control">Impedance Control</h3>

<p>In the field of robotics, impedance is a transfer function that relates the velocity V(s) of a robot to the force exerted at its end effector (F). This concept plays a crucial role in controlling the interaction between robots and their environment, allowing for adaptive and responsive behavior. Recent advancements in impedance control have focused on enhancing the robot’s ability to interact with complex and dynamic environments, leading to applications in areas such as manufacturing, healthcare, and disaster response. These developments aim to improve the safety, efficiency, and versatility of robotic systems, paving the way for their broader integration into various real-world scenarios.</p>

\[Z(s)=\frac{F(s)}{V(s)}=\frac{F(s)}{sX(s)}\]

<p>This math relation can be modeled as an action of an spring or compliance which has three parameter. The first one (m) stands for inertia, b for damping and K for stiffness.</p>

\[ms^2X(s)+bsX(s)+kX(s)=F(s)\]

\[Z(s)=sm+b+\frac{k}{s}\]

<p>With that, we can model force (F) respect a desired position:</p>

\[M_d(\ddot{x}-\ddot{x_d})+B_d(\dot{x}-\dot{x_d})+K_d(x-x_d)=F_A\]

<p>Also, we know that the dynamics of a manipulator robot is:</p>

\[M\ddot{x}+C\dot{x}+g=\tau\]

<p>Where M is inertia, C is Coriolis matrix, g is a gravity vector and tau is a vector of the torque actuators of the manipulator. When applying inverse dynamics, we can obtain the following.</p>

\[\tau = M_AJ^{-1}_A[\ddot{x}-J_A\dot{q}+M_d^{-1}(B_d(\dot{x}_d-\dot{x})+K_d(x_d-x))]+C\dot{q}+g+J^{T}_A(M_xMd^{-1}-I)F_A\]

<h3 id="implementation-in-the-open-manipulator">Implementation in the Open Manipulator</h3>

<p>This robot has 4 DoF and uses Dynamixel motors. However, it lacks on force or torque sensors so it makes it harder to apply an impedance control. Since, this robot has it open source packages, we can know the model (urdf) and the characteristics of the robot almost exactly, so we can apply an special case replacing in the general equation:</p>

\[M_d=M_x=J^{-T}_AMJ^{-1}_A\]

\[\tau=M_AJ^{-1}_A[\ddot{x}-J_A\dot{q}+M_d^{-1}(B_d(\dot{x}_d-\dot{x})+K_d(x_d-x))]+C\dot{q}+g\]

<p>That’s enough for achieving an impedance control. So now we are going to code this to run the code in our robot. We will be using the cpp node made by OpenManipulatorX <strong>(gravity compensator)[https://raw.githubusercontent.com/ROBOTIS-GIT/open_manipulator_controls/master/open_manipulator_controllers/src/gravity_compensation_controller.cpp]</strong>. We can clone it by typing this in our terminal</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd ~/catkin_ws/src/
$ git clone https://github.com/ROBOTIS-GIT/open_manipulator_controls.git
$ cd ~/catkin_ws &amp;&amp; catkin_make
</code></pre></div></div>

<p>After that, we will be locating the “gravity compensation controller” file in the /src directory. There we will be inserting the following piece of code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // Inverse Jacobian
  { J_pos_pinv_ = J_pos_.completeOrthogonalDecomposition().pseudoInverse(); }

  // Desired Inertial matrix
  Md_ = J_pos_pinv_.transpose() * M_.data * J_pos_pinv_;

  auto imposicion = Md_.inverse() * (Bd_ * (desired_x_dot_ - x_dot_eigen_) +
                                     Kd_ * (desired_x_ - x_eigen_));

  auto dinamica = desired_x_dot_dot_ - J_pos_dot_ * q_dot_.data + imposicion;

  tau_.data = M_.data * J_pos_pinv_ * dinamica + C_.data + G_.data;

</code></pre></div></div>
<p>Then we can run the controller by calling the following launch files</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>roslaunch open_manipulator_controller open_manipulator_controller.launch
roslaunch open_manipulator_controllers gravity_compensation_controller.launch
</code></pre></div></div>

<h2 id="results">Results</h2>

<iframe width="560" height="315" src="https://www.youtube.com/embed/r9iU3OYlKqc" frameborder="0" allowfullscreen="" align="center"></iframe>

<p>Here it is an article about this project (Spanish):</p>

<iframe src="/proj/proj6/final.pdf" height="500" width="900"></iframe>

<p>The code can be located <strong><a href="https://github.com/manul30/ImpedanceControl_OpenManipulator">here</a></strong>.</p>


    <p> </p>
    
<h3>Project posts</h3>
    
    <div class="well">
<div class="list-group">
    
    </div>
</div>

</article>

          <div class="row">
            <div class="col-md-12 col-xs-12 footer">
              <footer>
  © 2022-2024 Manuel Carita, <a href="/">Home</a> - Powered by Jekyll with <a href="https://github.com/codeasashu/hcz-jekyll-blog">HCZ Material theme</a>, inspired in <a href="https://nikolasent.github.io/">Nikola Falaleev's site</a>.
</footer>
<div align="center">
  <ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-0000000000000000"
    data-ad-slot="0000000000"
    data-ad-format="auto"></ins>
</div>

            </div>
          </div>
        </div> <!-- end /.col-md-9 -->
      </div> <!-- end /.row -->
    </div>

    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script src="/static/js/thickbox-compressed.js"></script>
<script src="/static/js/material.min.js"></script>
<script src="/static/js/main.js"></script>
<script src="/static/js/projects.js"></script>

  </body>
</html>
